<template>
  <require from="../container/container-status-formatter-valueconverter"></require>

  <ux-dialog style="min-width:800px;">
    <ux-dialog-header>
      <h4>Move stocks from Lot ${model.lotNo} into a container</h4>
    </ux-dialog-header>

    <ux-dialog-body>

      <!-- Quantity input -->
      <section class="mb-5">
        <div class="row">
          <div class="col">
            ${model.balance | numberFormat:"0,0"} bags available on stock
          </div>
          <div class="col">
            About ${model.balance * 80/1000 | numberFormat: "0,0"} tons available on stock
          </div>
        </div>

        <div class="row">
          <div class="col">
            <number-input value.bind="bags" label="Bags to add to container"></number-input>
          </div>
          <div class="col">
            <number-input value.bind="stockWeightKg" label="Approx. quantity kg to add to container"></number-input>
          </div>
        </div>
      </section>
      <!-- Quantity input -->

      <div class="form-label">Select a container to move the stock into</div>
      <ul class="list-group small" style="height:300px; overflow:auto">
        <li class="list-group-item font-weight-bold">
          <div class="row">
            <div class="col">Status</div>
            <div class="col">Container number</div>
            <div class="col">Booking number</div>
            <div class="col">Bags already in container</div>
            <div class="col">Incoming weight from stock</div>
          </div>
        </li>
        <li class="list-group-item ${item.selected ? 'list-group-item-highlight' : ''}" repeat.for="item of list">
          <a href="#" click.delegate="selectRow($index)" class="text-decoration-none">
            <div class="row">
              <div class="col">${item.status | containerStatusFormatter}

              </div>
              <div class="col">                
                <button type="button" class="btn-link" click.delegate="navigateToContainer(item.id) & debounce:200">${item.containerNumber}</button>
              </div>
              <div class="col">${item.bookingNumber}</div>
              <div class="col">${item.bags | numberFormat: "0,0"}
                <span if.bind = "item.isOverweight" class="ml-2">
                  <i class="fas fa-exclamation-triangle text-warning"
                    title="This container is possibly already at capacity"></i>
                </span>
              </div>
              <div class="col">${item.stockWeightKg | numberFormat: "0,0"}</div>
            </div>
          </a>
        </li>
      </ul>

      <div if.bind="isOverweightContainer" class="alert alert-warning mt-2">
        <i class="fas fa-exclamation-triangle"></i>
        ${loadingQuantity.bags | numberFormat: "0,0"} bags or ${loadingQuantity.stockWeightKg | numberFormat: "0,0"} kg may
        in excess of the capacity of the container
      </div>

    </ux-dialog-body>

    <ux-dialog-footer>
      <button type="button" class="btn btn-danger" disabled.bind="!canSave" click.delegate="okClicked()">Ok</button>
      <button type="button" class="btn btn-secondary" click.delegate="controller.cancel()">Cancel</button>
    </ux-dialog-footer>
  </ux-dialog>
</template>
