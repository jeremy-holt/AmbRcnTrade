<template>
  <toolbar type="menu" caption="Stock Balances" list-route="stockList">
    <toolbar-item icon="fas fa-container-storage" click.call="navigateToContainerList()"></toolbar-item>
  </toolbar>

  <div class="card card-">
    <div class="card-header">
      <h4>Stock Balances</h4>
      <div class="my-4">Select the <i class="fas fa-fw fa-container-storage text-primary"></i> container button to stuff a
        container</div>
      <div>There are ${numberEmptyContainers} empty container(s) available. <a route-href="containerList"
          class="with-decoration"><i class="fas fa-fw fa-container-storage mr-1"></i>Go to the containers list</a></div>          
    </div>

    <div class="card-body">
      <ul class="list-group small">
        <li class="list-group-item font-weight-bold">
          <div class="row">
            <div class="col-2">Lot no</div>
            <div class="col">Warehouse/ Supplier</div>
            <div class="text-right col">Balance Bags</div>
            <div class="text-right col">Balance kg</div>
            <div class="text-right col">Avg bag kg</div>
            <div class="col">Quality</div>
          </div>
        </li>
        <li class="list-group-item ${item.selected ? " list-group-item-danger" : '' }" repeat.for="item of list">
          <div class="row">
            <div class="col-2">
              <div>
                <a route-href="stockList; params.bind:{lotNo:item.lotNo, locationId:''}" class="with-decoration"><i
                    class="fas fa-fw fa-list mr-2"></i>Lot no
                  ${item.lotNo}</a>
              </div>

              <div>${item.analysisResults.length} stock entries</div>
              <div class="mt-2">
                <button type="button" class="btn btn-sm btn-primary" disabled.bind="!canAddContainer" click.delegate="openStuffContainerDialog(item)">
                  <i class="far fa-fw fa-container-storage mr-2"></i>Container
                </button>
              </div>
            </div>

            <div class="col"><a class="with-decoration text-nowrap"
                route-href="stockList; params.bind:{lotNo:-1, locationId:encode(item.locationId)}"><i
                  class="fas fa-fw fa-warehouse mr-2"></i>${item.locationName}/<br>
                <i class="fas fa-fw fa-user-cowboy mr-2"></i>${item.supplierName}</a>
            </div>

            <div class="text-right col font-weight-bold">${item.balance | numberFormat:"0,0"}</div>

            <div class="text-right col font-weight-bold">${item.balanceWeightKg | numberFormat:"0,0"}
              <div>
                <button type="button" class="btn btn-danger btn-sm mt-2" if.bind="!item.zeroedStock" click.delegate="zeroStock(item)">Zero the stock</button>
                <div if.bind="item.zeroedStock" class="font-weight-bold text-danger">Stock Zeroed</div>
              </div>
            </div>

            <div class="text-right col">${item.avgBagWeightKg | numberFormat: "0,0.00"}</div>

            <div class="col">Kor: ${item.kor | numberFormat: "0,.00"}, Count: ${item.count | numberFormat: "0,0.0"},
              Moisture: ${item.moisture/100 | numberFormat:"0.00%"}</div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</template>
