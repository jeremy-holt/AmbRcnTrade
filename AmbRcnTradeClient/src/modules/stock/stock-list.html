<template>
  <toolbar type="menu" caption="Stocks">
    <toolbar-item icon="fa fa-plus" click.call="addStock()"></toolbar-item>
  </toolbar>

  <div class="mb-4 d-flex justify-content-between align-items-end">
    <div class="mr-2 w-100">
      <select-input source.bind="locations" value.bind="selectedLocation" label="Select warehouse location" warn-null="false">
      </select-input>
    </div>

    <div class="mr-2 w-100">
      <number-input value.bind="selectedLotNo" label="Search by lot no"></number-input>
    </div>
    <div>
      <button type="button" class="btn btn-sm btn-primary" click.delegate="runQuery()">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </div>

  <table class="table table-sm small">
    <thead>
      <tr>
        <th>Lot no</th>
        <th>Date</th>
        <th>Location</th>        
        <th>Origin</th>
        <th>Stock in</th>
        <th>Stock out</th>
        <th>Avg. quality</th>
        <th>Inspected on</th>
      </tr>
    </thead>
    <tr repeat.for="item of list">
      <td>
        <a route-href="stockEdit; params.bind:{id: encode(item.stockId)}" class="with-decoration">Stock: Lot ${item.lotNo}</a>
      </td>
      <td>${item.date | dateFormat: "DD/MM/YYYY"}</td>
      <td>${item.locationName}</td>      
      <td>${item.origin}</td>
      <td>
        <div>${item.bagsIn | numberFormat: "0,0"} bags
        </div>
      </td>
      <td>
        <div if.bind="item.bagsOut > 0">
          ${item.bagsOut | numberFormat: "0,0"} bags
        </div>
      </td>
      <td>
        KOR ${item.inspection.analysisResult.kor | numberFormat: "0,0.00"}<br>
        Count ${item.inspection.analysisResult.count | numberFormat: "0,0"}<br>
        Moisture ${item.inspection.analysisResult.moisture/100 | numberFormat: "0.00%"}
      </td>
      <td>
        <a route-href="inspectionEdit; params.bind:{id: encode(item.inspectionId)}" class="with-decoration">Inspection: ${item.inspection.inspectionDate | dateFormat: "DD/MM/YYYY"}</a>
      </td>
    </tr>
  </table>
</template>
