<template>
  <toolbar type="menu" caption="Container" disabled-save.bind="!canSave" save.call="save()" list-route="containerList">
    <!-- <toolbar-item icon = "fa fa-plus" click.call="addContainer()"></toolbar-item> -->
  </toolbar>

  <div class="card">
    <div class="card-header">
      <h4 if.bind="model.id">Container ${model.containerNumber}</h4>
      <h4 else>New container</h4>
    </div>

    <div class="card-body">
      <div class="row">
        <div class="col">
          <h4>${model.bags | numberFormat: "0,0"} bags</h4>
        </div>
        <div class="col">
          <h4 class="${model.weighbridgeWeightKg == 0 ? 'text-danger' : ''}">${model.weighbridgeWeightKg | numberFormat: "0,0"} kg final weight</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-6">
          <select-input source.bind="containerStatusList" value.bind="selectedContainerStatus" label="Status">
          </select-input>
        </div>
        <div class="col">
          <text-input value.bind="model.bookingNumber" label="Booking number"></text-input>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <text-input value.bind="model.containerNumber" label="Container number"></text-input>
        </div>
        <div class="col">
          <text-input value.bind="model.sealNumber" label="Seal number"></text-input>
        </div>
      </div>

      <div class="row">
        <div class="col-6">
          <date-input value.bind="model.dispatchDate" label="Dispatched from warehouse to port"></date-input>
        </div>
        <div class="col">
          <select-input source.bind="teuList" value.bind="model.teu" label="TEU" use-model-id="true"></select-input>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <number-input value.bind="model.weighbridgeWeightKg" label="Weighbridge weight kg"></number-input>
        </div>
        <div class="col">
          <number-input value.bind="model.netWeightKg" label="Container nett weight"></number-input>
        </div>
      </div>

      <div class="row mt-2">
        <div class="col">
          <div class="form-label">Stuffing information</div>
          <ul class="list-group">
            <li class="list-group-item">
              <div repeat.for="item of model.incomingStocks" class="row">
                <div class="col">${item.bags | numberFormat:"0,0"} bags 
                  <span class="small font-italic">(approx. ${item.bags * 80 | numberFormat: "0,0"} kg)</span></div>
                <div class="col">
                  <a class="with-decoration" route-href="stockBalanceList; params.bind:{lotNo:item.lotNo}">Lot no:
                    ${item.lotNo}</a>
                </div>
                <div class="col">Stuffed on ${item.stuffingDate | dateFormat: "DD/MM/YYYY"}</div>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div class="row mt-2">
        <div class="col">
          <button type="button" class="btn btn-danger" disabled.bind="!canUnstuffContainer"
            click.delegate="unstuffContainer()">Unstuff container</button>
          <div class="mt-2 text-warning" if.bind="!canUnstuffContainer">
            Cannot unstuff container that is no longer in the warehouse or has no contents
          </div>
        </div>
      </div>

    </div>
  </div>
</template>
